{"pageContext":{"html":"<p><a href=\"ctf=trend-micro-ctf-2015\"></a>\n<a href=\"type=prog\"></a>\n<a href=\"tags=roman,parsing\"></a>\n<a href=\"tools=\"></a>\n<a href=\"techniques=\"></a></p>\n<h1>Calculator (prog-200)</h1>\n<p>Again, problem is simple: We're given simple arithmetic questions, we need to calculate their values.</p>\n<p>In the start, it's quite simple as the questions contained just numbers and operators. Python's <code>eval()</code> would've been more than enough, but as level increase, we get numbers separated by commas (like 62,234,612). Even more, we start to see roman numerals (CMXIV), and finally even numbers in plain english! (six hundred twenty two).</p>\n<p>To automate this, we wrote a python script which after reading each question, does the following:</p>\n<p><code>python def solve(ques): # We only need lhs ques = ques.split(\"=\")[0] # We don't need commas ques = ques.repace(',', '') parsed = '' # Let's separate parts between operators groups = re.split('([\\-\\+\\*\\/\\(\\)])', ques) # Convert each part to a number for g in groups: g = g.strip() # If part a roman numeral, convert it to decimal if re.match('([A-Z]+)', g): parsed += \"%s\" % roman.fromRoman(g) # If part is in plain english, convert it to decimal elif re.match('([a-z]+)', g): parsed += \"%s\" % text2int(g) else: parsed += g # Now eval can do the rest return \"%s\\r\\n\" % (eval(parsed))</code>\n(Complete code is in <a href=\"/bot-02b115037d622b74e8cb69958e9a9b36.py\">bot.py</a>)</p>\n<p>After about 100 levels, we get the flag:</p>\n<blockquote>\n<p>TMCTF{U D1D 17!}</p>\n</blockquote>","relativePath":"writeups/trend-micro-ctf-2015/prog/calculator/chaitan94"}}