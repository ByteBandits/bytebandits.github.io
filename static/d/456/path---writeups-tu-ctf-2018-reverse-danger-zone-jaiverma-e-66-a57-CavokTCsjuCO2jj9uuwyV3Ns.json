{"pageContext":{"html":"<p><a href=\"ctf=tu-ctf-2018\"></a>\n<a href=\"type=reversing\"></a>\n<a href=\"tags=python,pyc\"></a>\n<a href=\"tools=uncompyle6,python\"></a></p>\n<h1>Danger Zone</h1>\n<p>We are given a python bytecode <a href=\"/dangerzone-bdb7b9b8bf16d159e0176b0d9b76e009.pyc\">file</a>.</p>\n<p>We can decompile it with <strong>uncompyle6</strong>.</p>\n<p>`<code></code>bash\nvagrant@amy:~/share/Danger Zone$ uncompyle6 dangerzone.pyc</p>\n<h1>uncompyle6 version 3.2.4</h1>\n<h1>Python bytecode 2.7 (62211)</h1>\n<h1>Decompiled from: Python 2.7.10 (default, Oct  6 2017, 22:29:07)</h1>\n<h1>[GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.31)]</h1>\n<h1>Embedded file name: ./dangerzone.py</h1>\n<h1>Compiled at: 2018-11-22 12:44:11</h1>\n<p>import base64</p>\n<p>def reverse(s):\nreturn s[::-1]</p>\n<p>def b32decode(s):\nreturn base64.b32decode(s)</p>\n<p>def reversePigLatin(s):\nreturn s[-1] + s[:-1]</p>\n<p>def rot13(s):\nreturn s.decode('rot13')</p>\n<p>def main():\nprint 'Something Something Danger Zone'\nreturn '=YR2XYRGQJ6KWZENQZXGTQFGZ3XCXZUM33UOEIBJ'</p>\n<p>if <strong>name</strong> == '<strong>main</strong>':\ns = main()\nprint s</p>\n<h1>okay decompiling dangerzone.pyc</h1>\n<p>`<code></code></p>\n<p>The flag can be found by calling each of these functions successively after <code>main</code>.</p>\n<p>`<code></code>python\nimport dangerzone as dz</p>\n<p>s = dz.main()\ns = dz.reverse(s)\ns = dz.b32decode(s)\ns = dz.reversePigLatin(s)\ns = dz.rot13(s)</p>\n<p>print s\n`<code></code></p>\n<p><code>bash vagrant@amy:~/share/Danger Zone$ python exploit.py Something Something Danger Zone TUCTF{r3d_l1n3_0v3rl04d}</code></p>\n<p>Flag</p>\n<blockquote>\n<p>TUCTF{r3d<em>l1n3</em>0v3rl04d}</p>\n</blockquote>","relativePath":"writeups/tu-ctf-2018/reverse/danger-zone/jaiverma"}}