{"pageContext":{"html":"<p><a href=\"ctf=trend-micro-ctf-2015\"></a>\n<a href=\"type=prog\"></a>\n<a href=\"tags=roman,parsing\"></a>\n<a href=\"tools=\"></a>\n<a href=\"techniques=\"></a></p>\n<h1>Calculator (prog-200)</h1>\n<p>Again, problem is simple: We're given simple arithmetic questions, we need to calculate their values.</p>\n<p>In the start, it's quite simple as the questions contained just numbers and operators. Python's <code>eval()</code> would've been more than enough, but as level increase, we get numbers separated by commas (like 62,234,612). Even more, we start to see roman numerals (CMXIV), and finally even numbers in plain english! (six hundred twenty two).</p>\n<p>To automate this, we wrote a python script which after reading each question, does the following:</p>\n<pre><code class=\"language-python\">def solve(ques):\n    # We only need lhs\n    ques = ques.split(\"=\")[0]\n    # We don't need commas\n    ques = ques.repace(',', '')\n    parsed = ''\n    # Let's separate parts between operators\n    groups = re.split('([\\-\\+\\*\\/\\(\\)])', ques)\n    # Convert each part to a number\n    for g in groups:\n        g = g.strip()\n        # If part a roman numeral, convert it to decimal\n        if re.match('([A-Z]+)', g):\n            parsed += \"%s\" % roman.fromRoman(g)\n        # If part is in plain english, convert it to decimal\n        elif re.match('([a-z]+)', g):\n            parsed += \"%s\" % text2int(g)\n        else: parsed += g\n    # Now eval can do the rest\n    return \"%s\\r\\n\" % (eval(parsed))\n</code></pre>\n<p>(Complete code is in <a href=\"bot.py\">bot.py</a>)</p>\n<p>After about 100 levels, we get the flag:</p>\n<blockquote>\n<p>TMCTF{U D1D 17!}</p>\n</blockquote>"}}