{"pageContext":{"html":"<p><a href=\"ctf=tu-ctf-2018\"></a>\n<a href=\"type=reversing\"></a>\n<a href=\"tags=malloc,memcpy\"></a>\n<a href=\"tools=radare2,gdb-peda\"></a></p>\n<h1>yeahright</h1>\n<p>We are given a <a href=\"/yeahright-3ea48528d2884667e9cf1563fe3de20c.\">binary</a> which accepts user input and does a memcmp with a string.</p>\n<p><code>bash vagrant@amy:~/share/yeahright$ file yeahright yeahright: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=0b6d0cc001d9c9c8fb8e1e61f8b082bcda503669, not stripped</code></p>\n<p>`<code></code>assembly\ngdb-peda$ c\nContinuing.\n<em>Ahem</em>... password? aaaa\n[----------------------------------registers-----------------------------------]\nRAX: 0x555555756010 --> 0xa61616161 ('aaaa\\n')\nRBX: 0x0\nRCX: 0x555555554a98 (\"7h3<em>m057</em>53cr37357<em>p455w0rd</em>y0u<em>3v3r</em>54w\")\nRDX: 0x28 ('(')\nRSI: 0x555555554a98 (\"7h3<em>m057</em>53cr37357<em>p455w0rd</em>y0u<em>3v3r</em>54w\")\nRDI: 0x555555756010 --> 0xa61616161 ('aaaa\\n')\nRBP: 0x7fffffffe0f0 --> 0x555555554a10 (&#x3C;<strong>libc<em>csu</em>init>:  push   r15)\nRSP: 0x7fffffffe0e0 --> 0x7fffffffe1d0 --> 0x1\nRIP: 0x5555555549cf (&#x3C;main+143>:    call   0x5555555547c0 <a href=\"mailto:memcmp@plt\">memcmp@plt</a>)\nR8 : 0x7ffff7fec700 (0x00007ffff7fec700)\nR9 : 0x14\nR10: 0x37b\nR11: 0x246\nR12: 0x555555554810 (&#x3C;<em>start>:  xor    ebp,ebp)\nR13: 0x7fffffffe1d0 --> 0x1\nR14: 0x0\nR15: 0x0\nEFLAGS: 0x203 (CARRY parity adjust zero sign trap INTERRUPT direction overflow)\n[-------------------------------------code-------------------------------------]\n0x5555555549c4 &#x3C;main+132>:   mov    edx,0x28\n0x5555555549c9 &#x3C;main+137>:   mov    rsi,rcx\n0x5555555549cc &#x3C;main+140>:   mov    rdi,rax\n=> 0x5555555549cf &#x3C;main+143>:   call   0x5555555547c0 <a href=\"mailto:memcmp@plt\">memcmp@plt</a>\n0x5555555549d4 &#x3C;main+148>:   test   eax,eax\n0x5555555549d6 &#x3C;main+150>:   je     0x5555555549ee &#x3C;main+174>\n0x5555555549d8 &#x3C;main+152>:   lea    rdi,[rip+0xf7]        # 0x555555554ad6\n0x5555555549df &#x3C;main+159>:   call   0x555555554780 <a href=\"mailto:puts@plt\">puts@plt</a>\nGuessed arguments:\narg[0]: 0x555555756010 --> 0xa61616161 ('aaaa\\n')\narg[1]: 0x555555554a98 (\"7h3</em>m057<em>53cr37357</em>p455w0rd<em>y0u</em>3v3r<em>54w\")\narg[2]: 0x28 ('(')\narg[3]: 0x555555554a98 (\"7h3</em>m057<em>53cr37357</em>p455w0rd<em>y0u</em>3v3r_54w\")\n[------------------------------------stack-------------------------------------]\n0000| 0x7fffffffe0e0 --> 0x7fffffffe1d0 --> 0x1\n0008| 0x7fffffffe0e8 --> 0x555555756010 --> 0xa61616161 ('aaaa\\n')\n0016| 0x7fffffffe0f0 --> 0x555555554a10 (&#x3C;</strong>libc<em>csu</em>init>: push   r15)\n0024| 0x7fffffffe0f8 --> 0x7ffff7a2d830 (&#x3C;_<em>libc</em>start_main+240>:   mov    edi,eax)\n0032| 0x7fffffffe100 --> 0x1\n0040| 0x7fffffffe108 --> 0x7fffffffe1d8 --> 0x7fffffffe46a (\"/home/vagrant/share/yeahright/yeahright\")\n0048| 0x7fffffffe110 --> 0x1f7ffcca0\n0056| 0x7fffffffe118 --> 0x555555554940 (<main>:    push   rbp)\n[------------------------------------------------------------------------------]\nLegend: code, data, rodata, value</p>\n<p>Breakpoint 2, 0x00005555555549cf in main ()\n`<code></code></p>\n<p>Submitting the string <code>7h3_m057_53cr37357_p455w0rd_y0u_3v3r_54w</code> to the server gives us the flag.</p>\n<p>Flag</p>\n<blockquote>\n<p>TUCTF{n07<em>my</em>fl46<em>n07</em>my_pr0bl3m}</p>\n</blockquote>","relativePath":"writeups/tu-ctf-2018/reverse/yeahright/jaiverma"}}