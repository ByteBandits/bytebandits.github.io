{"pageContext":{"html":"<p><a href=\"ctf=hackover-2015\"></a>\n<a href=\"type=web\"></a>\n<a href=\"tags=headers\"></a>\n<a href=\"tools=burp-proxy\"></a></p>\n<h1>hack-the-planet (web-50)</h1>\n<p>`<code></code>\nHacking a site is basic task for any skilled hacker.\nMethods range from brute force to talking to people.\nNo matter which method you choose, don't forget to use head.</p>\n<p>HINT: His question is the answer\nhttp://hack-the-planet.hackover.h4q.it\n`<code></code>\nPartial code from <a href=\"/hack-the-planet-275983b5101b4c089443f0486c6bfb03-275983b5101b4c089443f0486c6bfb03.go\">source</a>.</p>\n<p>`<code></code>go\npackage main</p>\n<p>const (\nflagPW = \"XXX\"\nflag   = \"hackover15{XXX}\"\n)</p>\n<p>func login(w http.ResponseWriter, r *http.Request) {\nswitch r.Method {\ncase \"HEAD\":\nhint(w, r)\ncase \"POST\":\ncheck(w, r)\ndefault:\ngotoFail(w, r, \"/fail.jpg\", http.StatusMethodNotAllowed)\n}\n}</p>\n<p>func hint(w http.ResponseWriter, r *http.Request) {\nif r.Header.Get(\"X-XXX\") == \"XXX\" {\nw.Header().Set(\"X-XXX\", flagPW)\nw.WriteHeader(http.StatusAccepted)\nreturn\n}\nw.Header().Set(\"X-XXX\", \"XXX\")\nw.WriteHeader(http.StatusPartialContent)\n}</p>\n<p>func check(w http.ResponseWriter, r *http.Request) {\nif err := r.ParseForm(); err != nil {\ngotoFail(w, r, \"fail.jpg\", 401)\n}\nif r.PostForm.Get(\"pw\") != flagPW {\ngotoFail(w, r, \"fail.jpg\", 401)\n}</p>\n<pre><code>w.WriteHeader(http.StatusAccepted)\nif _, err := w.Write([]byte(flag)); err != nil {\n}\n</code></pre>\n<p>}\n`<code></code></p>\n<p>The hint is pretty obvious and the code block too.\nWe use burp pxoxy to change the verb to HEAD.\nIn the response we get \"X-Hackers-Kate-Libby\": \"make it my first-born!\"\nSearching for this we find Its a dialogue from \"Hackers\" movie.</p>\n<p><code>Kate Libby: You wish! You'll do shitwork, scan, crack copyrights... Dade Murphy: And if I win? Kate Libby: Make it my first-born! Dade Murphy: Make it our first-date! Kate Libby: I don't DO dates. But I don't lose either, so you're on!</code>\nAnd the hint: </p>\n<p>HINT: His question is the answer </p>\n<p>So we send a header:\n<code>\"X-Hackers-Dade-Murphy\": \"And if I win?\"</code>\nWe get\n<code>\"X-Hackers-The-Five-Most-Used-Passwords-Are\": \"password,secret,love,god,sex\"</code>\nin the response.\nUse password,secret,love,god,sex as password to login. We get the flag.</p>\n<blockquote>\n<p>hackover15{Thepoolontheroofnusthavealeak}</p>\n</blockquote>","relativePath":"writeups/hackover-ctf-2015/web/hack-the-planet/sudhackar"}}