{"pageContext":{"html":"<p><a href=\"ctf=hackover-2015\"></a>\n<a href=\"type=reverse\"></a>\n<a href=\"tags=reverse,recovery\"></a>\n<a href=\"tools=binwalk,gdb-peda\"></a></p>\n<h1>goto (reverse-150)</h1>\n<p>We have a <a href=\"/goto-03661d1a42ad20065ef6bfbe5a06287c-d11a5f49679dd68b82e42338d26e447a.tgz\">zip</a> file.\nUnzipping it gives us a file goto.bin</p>\n<p><code>bash $ file goto.bin goto.bin: data</code>\ndata is somewhat nasty for a 150 pt challenge. So I used binwalk on it.</p>\n<p>`<code></code>bash\n$ binwalk -e goto.bin </p>\n<h2>DECIMAL       HEXADECIMAL     DESCRIPTION</h2>\n<p>74            0x4A            gzip compressed data, maximum compression, has original file name: \"rvs\", from Unix, last modified: Thu Oct 15 19:19:35 2015</p>\n<p>$ file _goto.bin.extracted/rvs\n_goto.bin.extracted/rvs: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), for GNU/Linux 2.6.24, dynamically linked, interpreter \\004, stripped\n`<code></code></p>\n<p>This could work.\n`<code></code>bash\n$ ./rvs\nPASSWORD:sudhackar</p>\n<p>ACCESS DENIED\n`<code></code></p>\n<p>I have observed it in many CTFs that how much has gdb-peda made the problems trivial to solve. So we quickly load it in gdb-peda and step through the program.\n<code>bash gdb-peda$ b *0x400630 Breakpoint 1 at 0x400630 gdb-peda$ b *0x4006aa Breakpoint 2 at 0x4006aa</code></p>\n<p>After some running and stepping.</p>\n<p>`<code></code>bash\ngdb-peda$ c\nContinuing.\n[----------------------------------registers-----------------------------------]\nRAX: 0x60109e (\"eSODoe#GtrWOEnr$Re1OONnt%Ao5ROIa ^Nr{DaE y&#x26;TCI\\020sDgo#ET<em>\\020l\\020iu$DFU\\020d\\020v!%\\020</em>S\\020j\\020e\\020^\\020{E\\020k\\020 \\020&#x26;\\020t<em>\\020a\\020y\\020(\\020hG\\020s\\020o\\020^\\020iO\\020d\\020u\\020&#x26;\\020sT\\020j\\020 \\020*\\020iO\\020k\\020u\\020^\\020s</em>\\020l\\020p\\020&#x26;\\020aW\\020a\\020,\\020*\\020dH\\020s\\020 \\020@\\020eE\\020d\\020n\\020#\\020cR\\020j\\020e\\020\\060\\020oE\\020k\\020v\\020$\\020yE\\020l\\020e\\020%\\020}V\\020\"...)\nRBX: 0x7fffffffdfe8 ('A' &#x3C;repeats 16 times>)\nRCX: 0x4141414141414176 ('vAAAAAAA')\nRDX: 0x602015 --> 0x0\nRSI: 0x7ffff7ff4011 --> 0x0\nRDI: 0x7fffffffdff9 --> 0x100000000000000\nRBP: 0x602010 --> 0x6f6b636168 ('hacko')\nRSP: 0x7fffffffdfe0 --> 0x7ffff7a431a8 --> 0xc001200002832\nRIP: 0x4006aa (cmp    cl,0x10)\nR8 : 0x7ffff7ff4011 --> 0x0\nR9 : 0x0\nR10: 0x10\nR11: 0x246\nR12: 0x40077f (xor    ebp,ebp)\nR13: 0x7fffffffe120 --> 0x1\nR14: 0x0\nR15: 0x0\nEFLAGS: 0x202 (carry parity adjust zero sign trap INTERRUPT direction overflow)\n[-------------------------------------code-------------------------------------]\n0x40069e:\tmov    eax,0x601068\n0x4006a3:\tadd    rax,0x9\n0x4006a7:\tmov    cl,BYTE PTR [rax-0x9]\n=> 0x4006aa:\tcmp    cl,0x10\n0x4006ad:\tje     0x4006b6\n0x4006af:\tmov    BYTE PTR [rdx],cl\n0x4006b1:\tinc    rdx\n0x4006b4:\tjmp    0x4006a3\n[------------------------------------stack-------------------------------------]\n0000| 0x7fffffffdfe0 --> 0x7ffff7a431a8 --> 0xc001200002832\n0008| 0x7fffffffdfe8 ('A' &#x3C;repeats 16 times>)\n0016| 0x7fffffffdff0 (\"AAAAAAAA\")\n0024| 0x7fffffffdff8 --> 0x0\n0032| 0x7fffffffe000 --> 0x1\n0040| 0x7fffffffe008 --> 0x4008dd (add    rbx,0x1)\n0048| 0x7fffffffe010 --> 0xf0b2dd\n0056| 0x7fffffffe018 --> 0x0\n[------------------------------------------------------------------------------]\nLegend: code, data, rodata, value</p>\n<p>Breakpoint 2, 0x00000000004006aa in ?? ()\n`<code></code>\nIf we notice RBP we'll se that our flag has started. Some continue's  later:</p>\n<p>`<code></code>bash</p>\n<p>Continuing.\n[----------------------------------registers-----------------------------------]\nRAX: 0x6011d0 --> 0x1010107910691010\nRBX: 0x7fffffffdfe8 ('A' &#x3C;repeats 16 times>)\nRCX: 0x4141414141414110\nRDX: 0x602037 --> 0x0\nRSI: 0x7ffff7ff4011 --> 0x0\nRDI: 0x7fffffffdff9 --> 0x100000000000000\nRBP: 0x602010 (\"hackover15{I<em>USE</em>GOTO<em>WHEREEVER</em>I_W4NT}\")\nRSP: 0x7fffffffdfe0 --> 0x7ffff7a431a8 --> 0xc001200002832\nRIP: 0x4006aa (cmp    cl,0x10)\nR8 : 0x7ffff7ff4011 --> 0x0\nR9 : 0x0\nR10: 0x10\nR11: 0x246\nR12: 0x40077f (xor    ebp,ebp)\nR13: 0x7fffffffe120 --> 0x1\nR14: 0x0\nR15: 0x0\nEFLAGS: 0x212 (carry parity ADJUST zero sign trap INTERRUPT direction overflow)\n[-------------------------------------code-------------------------------------]\n0x40069e:\tmov    eax,0x601068\n0x4006a3:\tadd    rax,0x9\n0x4006a7:\tmov    cl,BYTE PTR [rax-0x9]\n=> 0x4006aa:\tcmp    cl,0x10\n0x4006ad:\tje     0x4006b6\n0x4006af:\tmov    BYTE PTR [rdx],cl\n0x4006b1:\tinc    rdx\n0x4006b4:\tjmp    0x4006a3\n[------------------------------------stack-------------------------------------]\n0000| 0x7fffffffdfe0 --> 0x7ffff7a431a8 --> 0xc001200002832\n0008| 0x7fffffffdfe8 ('A' &#x3C;repeats 16 times>)\n0016| 0x7fffffffdff0 (\"AAAAAAAA\")\n0024| 0x7fffffffdff8 --> 0x0\n0032| 0x7fffffffe000 --> 0x1\n0040| 0x7fffffffe008 --> 0x4008dd (add    rbx,0x1)\n0048| 0x7fffffffe010 --> 0xf0b2dd\n0056| 0x7fffffffe018 --> 0x0\n[------------------------------------------------------------------------------]\nLegend: code, data, rodata, value</p>\n<p>Breakpoint 2, 0x00000000004006aa in ?? ()\ngdb-peda$\nContinuing.</p>\n<p>ACCESS DENIED\n[Inferior 1 (process 18192) exited normally]\nWarning: not running or target is remote\ngdb-peda$\n`<code></code></p>\n<p>Flag</p>\n<blockquote>\n<p>hackover15{I<em>USE</em>GOTO<em>WHEREEVER</em>I_W4NT}</p>\n</blockquote>","relativePath":"writeups/hackover-ctf-2015/reverse/goto/sudhackar"}}