{"pageContext":{"html":"<p><a href=\"ctf=mma-ctf-2015\"></a>\n<a href=\"type=forensics\"></a>\n<a href=\"tags=\"></a>\n<a href=\"tools=wireshark,gimp\"></a>\n<a href=\"techniques=\"></a></p>\n<h1>Splitted (forensics-30)</h1>\n<p>We're given <a href=\"../splited.pcap\">a pcap file</a>, let's go ahead and open it in wireshark. We can easily see that a file called 'flag.zip' is being sent.. Let's filter required packets:</p>\n<blockquote>\n<p>http &#x26;&#x26; ip.src==192.168.4.10</p>\n</blockquote>\n<p>We see 8 packets, so exported all the 8 packets as HTTP objects (File > Export Objects.. > HTTP).</p>\n<p>From wireshark we can the range of each HTTP response,  as follows.</p>\n<table>\n<thead>\n<tr>\n<th>Packet No</th>\n<th>Range start</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>16</td>\n<td>2345</td>\n</tr>\n<tr>\n<td>26</td>\n<td>0</td>\n</tr>\n<tr>\n<td>36</td>\n<td>1407</td>\n</tr>\n<tr>\n<td>46</td>\n<td>2814</td>\n</tr>\n<tr>\n<td>56</td>\n<td>3283</td>\n</tr>\n<tr>\n<td>66</td>\n<td>469</td>\n</tr>\n<tr>\n<td>76</td>\n<td>938</td>\n</tr>\n<tr>\n<td>86</td>\n<td>1386</td>\n</tr>\n</tbody>\n</table>\n<p>Sorted them according to range start</p>\n<table>\n<thead>\n<tr>\n<th>Packet No</th>\n<th>Range start</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>26</td>\n<td>0</td>\n</tr>\n<tr>\n<td>66</td>\n<td>469</td>\n</tr>\n<tr>\n<td>76</td>\n<td>938</td>\n</tr>\n<tr>\n<td>86</td>\n<td>1386</td>\n</tr>\n<tr>\n<td>36</td>\n<td>1407</td>\n</tr>\n<tr>\n<td>16</td>\n<td>2345</td>\n</tr>\n<tr>\n<td>46</td>\n<td>2814</td>\n</tr>\n<tr>\n<td>56</td>\n<td>3283</td>\n</tr>\n</tbody>\n</table>\n<p>Renamed the exported packets to follow this order, and assembled them:</p>\n<pre><code class=\"language-bash\">$ mv packet-26 part-1.zip\n$ mv packet-66 part-2.zip\n$ mv packet-76 part-3.zip\n$ mv packet-86 part-4.zip\n$ mv packet-36 part-5.zip\n$ mv packet-16 part-6.zip\n$ mv packet-46 part-7.zip\n$ mv packet-56 part-8.zip\n$ cat part-*.zip > flag.zip\n$ unzip flag.zip\n</code></pre>\n<p>We see a file called 'flag.psd'. Opening it in GIMP, we see flag in the bottom layer</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8ed799dd56400fd2c8b8986c5852061c/3801a/screenshot.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 720px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 56.22254758418741%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABwUlEQVQoz3VR/W/TMBD1//83UChpmlHKtkogQJXGug6BEBRta0qTLm3TJI4TJ7bTLJ/95LoAE6A9Pd89/3B372zU7ryuy0pNatYk5al8VGsoT6Tms2br6LijvDpV2qcg5NZxvdlqvDxp1OvPG7KsSFJD6rx5i1zXs7BnmmYkeJamaZIAk7s7iIdrmlQiS+Ifpv/uq/nhyumruDd0BxMPXQ3Vb4Prz18GtuNwzhgLgZyHlfjDkJKP1/OTS+39wOmOoq4qzkYcYWtycd6lnkspXa/L3W63vQfk39zt9/tIhOM5cZdrM8h0kk+8XPdydGOQ0YzMbJ8Qstms94/gMJwxEFWvCqj3fXp2Qy6HNqW+7xNYHrqAixCcUgprgIlfxeFDMQRISD6fmC7jdE4ILsui/Bur1aoaIgQzF84yYjCARyLLc3hF9KKnTV0eRyEh7nb7qG0othzMAoIdG2Os6zr4QkW6XJXFZrsF21ka53n6P4siZSy4NQx9cjseawEN+v2+NtZQ+9NCc0QcCYxdIQ5/df9h/wI2VtWhYRjT6ZRzbpkz5tvI43FRlEkS2wc4cKwDKv3AxcIaGwsRRVAJhiGGYfATqlNPrkrxF/MAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Screenshot\"\n        title=\"\"\n        src=\"/static/8ed799dd56400fd2c8b8986c5852061c/5b758/screenshot.png\"\n        srcset=\"/static/8ed799dd56400fd2c8b8986c5852061c/e6885/screenshot.png 180w,\n/static/8ed799dd56400fd2c8b8986c5852061c/e17e9/screenshot.png 360w,\n/static/8ed799dd56400fd2c8b8986c5852061c/5b758/screenshot.png 720w,\n/static/8ed799dd56400fd2c8b8986c5852061c/a00f5/screenshot.png 1080w,\n/static/8ed799dd56400fd2c8b8986c5852061c/3801a/screenshot.png 1366w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n      />\n  </span>\n  </a></p>\n<blockquote>\n<p>MMA{sneak_spy_sisters}</p>\n</blockquote>","relativePath":"writeups/mma-ctf-2015/forensics/splitted/chaitan94"}}