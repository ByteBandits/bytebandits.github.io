{"pageContext":{"html":"<p><a href=\"ctf=trend-micro-ctf-2015\"></a>\n<a href=\"type=crypto\"></a>\n<a href=\"tags=rsa\"></a>\n<a href=\"tools=factordb,rsatool,openssl\"></a>\n<a href=\"techniques=rsa\"></a></p>\n<h1>crypto-100</h1>\n<p>Problem description</p>\n<blockquote>\n<p>You're given an RSA public key and an encrypted message which contains a flag. Get the flag.</p>\n<p>There's also a hint about \"1bit\" being wrong in the public key.</p>\n<p>message: kPmDFLk5b/torG53sThWwEeNm0AIpEQek0rVG3vCttc=</p>\n</blockquote>\n<p>So lets go ahead and get the modulus (n) and exponent (e) from the given <a href=\"/PublicKey-e460ce2094f5e7a636a780941500ac21.pem\">public key</a>\n<code>bash $ openssl rsa -pubin -inform PEM -text -noout &#x3C; PublicKey.pem Public-Key: (256 bit) Modulus: 00:b6:2d:ce:9f:25:81:63:57:23:db:6b:18:8f:12: f0:46:9c:be:e0:cb:c5:da:cb:36:c3:6e:0c:96:b6: ea:7b:fc Exponent: 65537 (0x10001)</code>\nn's value in base 10 is 82401872610398250859431855480217685317486932934710222647212042489320711027708</p>\n<p>Hmm, n is even? Question says 1 bit is wrong.. it has to be last bit!</p>\n<p>So, n must be 82401872610398250859431855480217685317486932934710222647212042489320711027709</p>\n<p>Lets try http://www.factordb.com/index.php?query=82401872610398250859431855480217685317486932934710222647212042489320711027709</p>\n<p>Perfect! Got p and q.</p>\n<p>Let's generate private key and decrypt\n<code>bash $ python2 rsatool.py -f PEM -o private.pem -p 279125332373073513017147096164124452877 -q 295214597363242917440342570226980714417 $ echo \"kPmDFLk5b/torG53sThWwEeNm0AIpEQek0rVG3vCttc=\" > flag.enc $ base64 -d flag.enc | openssl rsautl -decrypt -inkey private.pem</code></p>\n<p>Aand we get out flag</p>\n<blockquote>\n<p>TMCTF{$@!zbo4+qt9=5}</p>\n</blockquote>","relativePath":"writeups/trend-micro-ctf-2015/crypto/crypto-100/chaitan94"}}