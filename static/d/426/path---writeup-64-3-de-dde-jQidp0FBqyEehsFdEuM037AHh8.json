{"pageContext":{"html":"<p><a href=\"ctf=trend-micro-ctf-2015\"></a>\n<a href=\"type=crypto\"></a>\n<a href=\"tags=rsa\"></a>\n<a href=\"tools=factordb,rsatool,openssl\"></a>\n<a href=\"techniques=rsa\"></a></p>\n<h1>crypto-100</h1>\n<p>Problem description</p>\n<blockquote>\n<p>You're given an RSA public key and an encrypted message which contains a flag. Get the flag.</p>\n<p>There's also a hint about \"1bit\" being wrong in the public key.</p>\n<p>message: kPmDFLk5b/torG53sThWwEeNm0AIpEQek0rVG3vCttc=</p>\n</blockquote>\n<p>So lets go ahead and get the modulus (n) and exponent (e) from the given <a href=\"../PublicKey.pem\">public key</a></p>\n<pre><code class=\"language-bash\">$ openssl rsa -pubin -inform PEM -text -noout &#x3C; PublicKey.pem\nPublic-Key: (256 bit)\nModulus:\n    00:b6:2d:ce:9f:25:81:63:57:23:db:6b:18:8f:12:\n    f0:46:9c:be:e0:cb:c5:da:cb:36:c3:6e:0c:96:b6:\n    ea:7b:fc\nExponent: 65537 (0x10001)\n</code></pre>\n<p>n's value in base 10 is 82401872610398250859431855480217685317486932934710222647212042489320711027708</p>\n<p>Hmm, n is even? Question says 1 bit is wrong.. it has to be last bit!</p>\n<p>So, n must be 82401872610398250859431855480217685317486932934710222647212042489320711027709</p>\n<p>Lets try <a href=\"http://www.factordb.com/index.php?query=82401872610398250859431855480217685317486932934710222647212042489320711027709\">http://www.factordb.com/index.php?query=82401872610398250859431855480217685317486932934710222647212042489320711027709</a></p>\n<p>Perfect! Got p and q.</p>\n<p>Let's generate private key and decrypt</p>\n<pre><code class=\"language-bash\">$ python2 rsatool.py -f PEM -o private.pem -p 279125332373073513017147096164124452877 -q 295214597363242917440342570226980714417\n$ echo \"kPmDFLk5b/torG53sThWwEeNm0AIpEQek0rVG3vCttc=\" > flag.enc \n$ base64 -d flag.enc | openssl rsautl -decrypt -inkey private.pem\n</code></pre>\n<p>Aand we get out flag</p>\n<blockquote>\n<p>TMCTF{$@!zbo4+qt9=5}</p>\n</blockquote>"}}