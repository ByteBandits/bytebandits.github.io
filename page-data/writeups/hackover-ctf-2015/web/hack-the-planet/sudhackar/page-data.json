{"componentChunkName":"component---src-templates-writeup-js","path":"/writeups/hackover-ctf-2015/web/hack-the-planet/sudhackar","result":{"pageContext":{"html":"<p><a href=\"ctf=hackover-2015\"></a>\n<a href=\"type=web\"></a>\n<a href=\"tags=headers\"></a>\n<a href=\"tools=burp-proxy\"></a></p>\n<h1>hack-the-planet (web-50)</h1>\n<pre><code>Hacking a site is basic task for any skilled hacker.\nMethods range from brute force to talking to people.\nNo matter which method you choose, don't forget to use head.\n\nHINT: His question is the answer \nhttp://hack-the-planet.hackover.h4q.it\n</code></pre>\n<p>Partial code from <a href=\"/275983b5101b4c089443f0486c6bfb03/hack-the-planet-275983b5101b4c089443f0486c6bfb03.go\">source</a>.</p>\n<pre><code class=\"language-go\">package main\n\nconst (\n    flagPW = \"XXX\"\n    flag   = \"hackover15{XXX}\"\n)\n\n\nfunc login(w http.ResponseWriter, r *http.Request) {\n    switch r.Method {\n    case \"HEAD\":\n        hint(w, r)\n    case \"POST\":\n        check(w, r)\n    default:\n        gotoFail(w, r, \"/fail.jpg\", http.StatusMethodNotAllowed)\n    }\n}\n\nfunc hint(w http.ResponseWriter, r *http.Request) {\n    if r.Header.Get(\"X-XXX\") == \"XXX\" {\n        w.Header().Set(\"X-XXX\", flagPW)\n        w.WriteHeader(http.StatusAccepted)\n        return\n    }\n    w.Header().Set(\"X-XXX\", \"XXX\")\n    w.WriteHeader(http.StatusPartialContent)\n}\n\nfunc check(w http.ResponseWriter, r *http.Request) {\n    if err := r.ParseForm(); err != nil {\n        gotoFail(w, r, \"fail.jpg\", 401)\n    }\n    if r.PostForm.Get(\"pw\") != flagPW {\n        gotoFail(w, r, \"fail.jpg\", 401)\n    }\n\n    w.WriteHeader(http.StatusAccepted)\n    if _, err := w.Write([]byte(flag)); err != nil {\n    }\n}\n</code></pre>\n<p>The hint is pretty obvious and the code block too.\nWe use burp pxoxy to change the verb to HEAD.\nIn the response we get \"X-Hackers-Kate-Libby\": \"make it my first-born!\"\nSearching for this we find Its a dialogue from \"Hackers\" movie.</p>\n<pre><code>Kate Libby: You wish! You'll do shitwork, scan, crack copyrights...\nDade Murphy: And if I win?\nKate Libby: Make it my first-born!\nDade Murphy: Make it our first-date!\nKate Libby: I don't DO dates. But I don't lose either, so you're on!\n</code></pre>\n<p>And the hint: </p>\n<p>HINT: His question is the answer </p>\n<p>So we send a header:</p>\n<pre><code>\"X-Hackers-Dade-Murphy\": \"And if I win?\"\n</code></pre>\n<p>We get </p>\n<pre><code>\"X-Hackers-The-Five-Most-Used-Passwords-Are\": \"password,secret,love,god,sex\"\n</code></pre>\n<p>in the response.\nUse password,secret,love,god,sex as password to login. We get the flag.</p>\n<blockquote>\n<p>hackover15{Thepoolontheroofnusthavealeak}</p>\n</blockquote>","relativePath":"writeups/hackover-ctf-2015/web/hack-the-planet/sudhackar"}}}