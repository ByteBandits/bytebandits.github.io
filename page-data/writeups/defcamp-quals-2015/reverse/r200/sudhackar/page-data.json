{"componentChunkName":"component---src-templates-writeup-js","path":"/writeups/defcamp-quals-2015/reverse/r200/sudhackar","result":{"pageContext":{"html":"<p><a href=\"ctf=defcamp-quals-2015\"></a>\n<a href=\"type=reverse\"></a>\n<a href=\"tags=hardcoded\"></a></p>\n<p>We are given a <a href=\"/9d4e94c3f69ca15c35f2dd3bc1047e20/r200.bin\">binary</a>.</p>\n<pre><code class=\"language-bash\">$ file r200.bin \nr200.bin: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=22e68980e521b43c90688ed0693df78150b10211, stripped\n</code></pre>\n<p>This one has the same ptrace protection as in <a href=\"../../r100\">r100</a>.We use the same technique to bypass ptrace check.</p>\n<pre><code class=\"language-bash\">gdb-peda$ b *0x40087d\nBreakpoint 1 at 0x40087d\ngdb-peda$ r\n.\n.\ngdb-peda$ set $rax=0\n</code></pre>\n<p>Now the decompiling doesn't help much. We move to manually testing the flow path of binary.</p>\n<pre><code class=\"language-asm\">   mov    DWORD PTR [rbp-0x20],0x5\n   mov    DWORD PTR [rbp-0x1c],0x2\n   mov    DWORD PTR [rbp-0x18],0x7\n   mov    DWORD PTR [rbp-0x14],0x2\n   mov    DWORD PTR [rbp-0x10],0x5\n   mov    DWORD PTR [rbp-0xc],0x6\n</code></pre>\n<p>This seems interesting. A little bit of analysis shows </p>\n<pre><code class=\"language-bash\">0x4007af:   mov    rax,QWORD PTR [rip+0x2008ca]        # 0x601080\n</code></pre>\n<p>On examining memory at 0x601080 and nearby areas we see the obvious.</p>\n<pre><code class=\"language-bash\">gdb-peda$ x/2xw 0x602010\n0x602010:   0x00000001  0x0000006e\ngdb-peda$ x/2xw 0x602030\n0x602030:   0x00000002  0x0000006f\ngdb-peda$ x/2xw 0x602050\n0x602050:   0x00000003  0x00000070\ngdb-peda$ x/2xw 0x602070\n0x602070:   0x00000004  0x00000071\n</code></pre>\n<p>We see that 0x6e(n) is mapped to 0, 0x6f(o) to 2 and so on.\nso 5,2,7,2,5,6 gives us rotors</p>\n<p>Flag</p>\n<blockquote>\n<p>rotors</p>\n</blockquote>","relativePath":"writeups/defcamp-quals-2015/reverse/r200/sudhackar"}}}