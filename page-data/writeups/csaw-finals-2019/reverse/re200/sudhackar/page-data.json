{"componentChunkName":"component---src-templates-writeup-js","path":"/writeups/csaw-finals-2019/reverse/re200/sudhackar","result":{"pageContext":{"html":"<p><a href=\"ctf=csaw-finals-2019\"></a>\n<a href=\"type=reverse\"></a>\n<a href=\"tags=ida\"></a>\n<a href=\"tools=ida\"></a></p>\n<h1>counting (re-200)</h1>\n<p><a href=\"/8388a72342e7726230f6849fa62a53a7/counting.\">Binary</a></p>\n<p>The flag was referenced in different functions to check one byte each. IDA xrefs\ndid not work properly. So we just grep over the disassembly to find all 30\nbytes in the flag.</p>\n<pre><code class=\"language-python\">from idautils import *\nfrom idaapi import *\nfrom idc import *\nfrom sark import *\nflag = [32 for i in xrange(32)]\n\nfor segea in Segments():\n    for funcea in Functions(segea, SegEnd(segea)):\n        functionName = GetFunctionName(funcea)\n        print functionName\n        f = Function(funcea)\n        last_idx = 0\n        for line in f.lines:\n            if \"cs:flag\" in line.disasm:\n                if \"+\" in line.disasm:\n                    last_idx = int(line.disasm.split(\"+\")[1].replace(\"h\", \"\"), 16)\n            elif \"sub     cl\" in line.disasm:\n                try:\n                    print last_idx\n                    b = int(line.disasm.split(\",\")[1].replace(\"h\", \"\"), 16)\n                    flag[last_idx] = b\n                except:\n                    pass\n\nfor i, j in enumerate(\"flag{\"):\n    flag[i] = ord(j)\n\nflag[30] = ord(\"}\")\n\nprint \"\".join(map(chr,flag))\n</code></pre>","relativePath":"writeups/csaw-finals-2019/reverse/re200/sudhackar"}}}