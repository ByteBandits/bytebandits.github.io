{"componentChunkName":"component---src-templates-writeup-js","path":"/writeups/ekoparty-pre-ctf-2015/misc/password-manager/chaitan94","result":{"pageContext":{"html":"<p><a href=\"ctf=ekoparty-2015\"></a>\n<a href=\"type=misc\"></a>\n<a href=\"tags=pwsafe,john\"></a>\n<a href=\"tools=john\"></a>\n<a href=\"techniques=bruteforce-attack\"></a></p>\n<h1>Password Manager (misc-100)</h1>\n<p>We're given a <a href=\"/79634d024889733b0a196ebbd8182741/mypasswords.\">Password Safe V3 database</a> and a hint: [a-zA-Z0-9]{0,4}. So, time to use <a href=\"http://www.openwall.com/john/\">john</a> and crack it open!</p>\n<p>Let's run <a href=\"https://github.com/piyushcse29/john-the-ripper/blob/master/src/pwsafe2john.c\">pwsafe2john</a> on it and get a hash first, so that john can crack the password from the produced hash.</p>\n<pre><code class=\"language-bash\">$ pwsafe2john mypasswords > hash.txt\n</code></pre>\n<p>We also had a hint, so instead of letting john brute-force all possibilities, let's generate a wordlist and then run john using it:</p>\n<pre><code class=\"language-python\">ALNUM = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\"\nc = 0\nq = ''\n\ndef rec(i, s):\n    if i > 4: return\n    global c, q\n    c += 1\n    q += ''.join(s + ['\\n'])\n    if c % 100000 == 0:\n        with open(\"wordlist\", \"a\") as f:\n            f.write(q)\n        q = ''\n    for a in ALNUM:\n        rec(i + 1, s + [a])\n\nrec(0, [])\n</code></pre>\n<p>After running the above code, our wordlist will be generated (roughly 72 MB :P). Now, we just have to give this to john, and it is going to crack the password for us.</p>\n<pre><code class=\"language-bash\">$ john -w=wordlist hash.txt\n</code></pre>\n<p>Now let it run for a few minutes.. and we see that john cracked it: 'Ek0'</p>\n<p>Now installed <a href=\"http://pwsafe.info/\">pwsafe software</a>, and opened the given database with the password 'Ek0'</p>\n<p>Aaand there's our flag:</p>\n<blockquote>\n<p>EKO{password_managers_rulez}</p>\n</blockquote>","relativePath":"writeups/ekoparty-pre-ctf-2015/misc/password-manager/chaitan94"}}}