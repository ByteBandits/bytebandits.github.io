{"componentChunkName":"component---src-templates-writeup-js","path":"/writeups/tu-ctf-2018/reverse/danger-zone/jaiverma","result":{"pageContext":{"html":"<p><a href=\"ctf=tu-ctf-2018\"></a>\n<a href=\"type=reversing\"></a>\n<a href=\"tags=python,pyc\"></a>\n<a href=\"tools=uncompyle6,python\"></a></p>\n<h1>Danger Zone</h1>\n<p>We are given a python bytecode <a href=\"/bdb7b9b8bf16d159e0176b0d9b76e009/dangerzone.pyc\">file</a>.</p>\n<p>We can decompile it with <strong>uncompyle6</strong>.</p>\n<pre><code class=\"language-bash\">vagrant@amy:~/share/Danger Zone$ uncompyle6 dangerzone.pyc\n# uncompyle6 version 3.2.4\n# Python bytecode 2.7 (62211)\n# Decompiled from: Python 2.7.10 (default, Oct  6 2017, 22:29:07)\n# [GCC 4.2.1 Compatible Apple LLVM 9.0.0 (clang-900.0.31)]\n# Embedded file name: ./dangerzone.py\n# Compiled at: 2018-11-22 12:44:11\nimport base64\n\ndef reverse(s):\n    return s[::-1]\n\n\ndef b32decode(s):\n    return base64.b32decode(s)\n\n\ndef reversePigLatin(s):\n    return s[-1] + s[:-1]\n\n\ndef rot13(s):\n    return s.decode('rot13')\n\n\ndef main():\n    print 'Something Something Danger Zone'\n    return '=YR2XYRGQJ6KWZENQZXGTQFGZ3XCXZUM33UOEIBJ'\n\n\nif __name__ == '__main__':\n    s = main()\n    print s\n# okay decompiling dangerzone.pyc\n</code></pre>\n<p>The flag can be found by calling each of these functions successively after <code>main</code>.</p>\n<pre><code class=\"language-python\">import dangerzone as dz\n\ns = dz.main()\ns = dz.reverse(s)\ns = dz.b32decode(s)\ns = dz.reversePigLatin(s)\ns = dz.rot13(s)\n\nprint s\n</code></pre>\n<pre><code class=\"language-bash\">vagrant@amy:~/share/Danger Zone$ python exploit.py\nSomething Something Danger Zone\nTUCTF{r3d_l1n3_0v3rl04d}\n</code></pre>\n<p>Flag</p>\n<blockquote>\n<p>TUCTF{r3d_l1n3_0v3rl04d}</p>\n</blockquote>","relativePath":"writeups/tu-ctf-2018/reverse/danger-zone/jaiverma"}}}